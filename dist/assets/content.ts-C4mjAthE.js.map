{"version":3,"file":"content.ts-C4mjAthE.js","sources":["../../src/ts/content.ts"],"sourcesContent":["import { INSPECT_MAX_BYTES } from \"node:buffer\";\nimport { settings } from \"node:cluster\";\nimport * as globalFunctions from \"./globalFunctions\"\n// const debug:boolean = false;\n\nglobalFunctions.init()\nconsole.log(\"pythonImeTypoFixer:debug\",globalFunctions.debug);\n(async () => {\n    const setting = (await globalFunctions.getSetting()) as ExtensionSetting\n    globalFunctions.updateSetting(setting)\n})()\n\n//設定の変更を反映させる\nchrome.storage.onChanged.addListener((chnages, namespace: string) => {\n    if (namespace === 'local' && chnages['setting']) {\n        const newValue = chnages['setting'].newValue as Partial<ExtensionSetting>\n        let oldSetting = globalThis.pythonImeTypoFixer.setting\n        if (globalThis.pythonImeTypoFixer.functions?.isExtensionSetting(oldSetting)) {\n            const newSetting:ExtensionSetting = {...oldSetting,...newValue}\n            if (globalFunctions.debug) console.log(\"pythonImeTypoFixer:newSetting\", newSetting)\n            globalFunctions.updateSetting(newSetting)\n        }\n    }\n})\n\n/**\n * compositionendで変換確定後に変換する\n */\nwindow.addEventListener('compositionend', (e) => {\n    const target = e.target;\n    if (!globalThis.pythonImeTypoFixer.setting) return\n    if (!globalThis.pythonImeTypoFixer.setting.isActive) return\n    if (!(target instanceof HTMLInputElement || target instanceof HTMLTextAreaElement)) return console.info(\"pyてょん to python: This field is not supported\")\n    const targetReg: RegExp = /((p|ｐ|P|Ｐ)(y|ｙ|Y|Ｙ)(て|手)ょん)/g;\n    if (targetReg.test(e.data)) {\n        const newText = e.data.replace(targetReg, \"python\")\n        const start = target.selectionStart ?? 0;\n        const end = target.selectionEnd ?? 0;\n        if (globalFunctions.debug) {\n            console.log({\n                \"e.target\": e.target,\n                \"e.data\": e.data,\n                \"newText\": newText,\n                \"start\": start,\n                \"end\": end\n            })\n        }\n        target.setRangeText(newText, start - e.data.length, end, 'end')\n    }\n})"],"names":["globalFunctions.init","console","log","globalFunctions.debug","setting","globalFunctions.getSetting","globalFunctions.updateSetting","chrome","storage","onChanged","addListener","chnages","namespace","newValue","oldSetting","globalThis","pythonImeTypoFixer","functions","isExtensionSetting","newSetting","window","addEventListener","e","target","isActive","HTMLInputElement","HTMLTextAreaElement","info","targetReg","test","data","newText","replace","start","selectionStart","end","selectionEnd","setRangeText","length"],"mappings":"uEAKAA,IACAC,QAAQC,IAAI,2BAA2BC,GAAqB,WAExD,MAAMC,QAAiBC,IACvBC,EAA8BF,EAClC,EAJ4D,GAO5DG,OAAOC,QAAQC,UAAUC,YAAY,CAACC,EAASC,KAC3C,GAAkB,UAAdA,GAAyBD,EAAiB,QAAG,CAC7C,MAAME,EAAWF,EAAiB,QAAEE,SACpC,IAAIC,EAAaC,WAAWC,mBAAmBZ,QAC/C,GAAIW,WAAWC,mBAAmBC,WAAWC,mBAAmBJ,GAAa,CACzE,MAAMK,EAA8B,IAAIL,KAAcD,GAEtDP,EAA8Ba,EAClC,CACJ,IAMJC,OAAOC,iBAAiB,iBAAmBC,IACvC,MAAMC,EAASD,EAAEC,OACjB,IAAKR,WAAWC,mBAAmBZ,QAAS,OAC5C,IAAKW,WAAWC,mBAAmBZ,QAAQoB,SAAU,OACrD,KAAMD,aAAkBE,kBAAoBF,aAAkBG,qBAAsB,OAAOzB,QAAQ0B,KAAK,gDACxG,MAAMC,EAAoB,+BAC1B,GAAIA,EAAUC,KAAKP,EAAEQ,MAAO,CACxB,MAAMC,EAAUT,EAAEQ,KAAKE,QAAQJ,EAAW,UACpCK,EAAQV,EAAOW,gBAAkB,EACjCC,EAAMZ,EAAOa,cAAgB,EAUnCb,EAAOc,aAAaN,EAASE,EAAQX,EAAEQ,KAAKQ,OAAQH,EAAK,MAC7D"}